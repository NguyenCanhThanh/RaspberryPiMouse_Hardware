=========================
ハードもちょこっと解説
=========================

　本連載の主題はロボットのソフトウエアですが、ハードについても簡単に紹介しておきます。連載で紹介しているデバイスドライバを使えばハードは分からなくても問題なく動かせます。

　ブザーの回路は、GPIO番号19のピン（35番ピン）からの信号に合わせて3.3Vピン（17番ピン）から電流をブザーに流し込むように作られています。トランジスタがブザーのスイッチとして働き、GPIO 19に電圧をかけると音が鳴り、電圧を落とすと音が止まります。今回使用しているブザーは電圧をかけただけでは音が鳴らないもので、GPIO番号19ピンの信号を"0"と"1"を繰り返す必要があります。

　モーターの回路については、大別すると次の五つの部分から成り立っています。

* Raspberry Pi側でモータードライバー（SLA7070）をON/OFFする回路。GPIO番号5番ピンとSLA7070の「Ref」ピンがスイッチとなる電界効果トランジスタ（FET）を挟んでつながっている部分。SLA7070の「Ref」電圧が2V以上のときモーターに電流が流れません。2V以下のときは、「Ref」で指定した電圧がモーターに流す電流値を決めています。SLA7070の内部に電流検出用抵抗があり、0.305Ωです。今回の回路では「Ref」に10k/(180k+10k)×3.3V=0.174Vかかるので、I=E/R=0.174V/0.305Ω->0.570Aモーターに流れます。モーターの抵抗が20Ω、電源が11.1VなのでI=E/R=11.1V/20Ω->0.555Aと電流制限がかからないですが、4cellの場合、14.8V/20Ω->0.740Aとなり、電流制限するためシャーという音がします。今回は電流制限としてではなく、ステッピングモーターの制御ロジックとしてSLA7070を使用してモーターの制御を簡単にしています。

* Raspberry Piからモーターの回し方の指令値を入れる回路。と言ってもGPIO番号6番、13番のピンをSLA7070に短絡しているだけです。GPIO番号6番はモーターの回転方向を決めています。GPIO番号13番は1pulse入れると0.9deg回ります。

* モーターに充電池からの電流を流し込む回路。

* SLA7070のReset信号にコンデンサーC1と抵抗R3で簡易リセット回路が付加しています。SLA7070の起動時、モーターを回すシーケンスが不定であるため、このReset信号によってシーケンスを確立させます。今回はコンデンサーと抵抗で簡易リセットを組んでいますが、Raspberry PiのGPIOからでも制御をすることは可能です。

* SLA7070のM1、M2、M3で1相励磁、2相励磁、1-2相励磁を切り替えることが可能です。今回は1-2相励磁に設定しています。
